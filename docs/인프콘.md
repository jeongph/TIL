- 네이버 김대성
- 16:10~16:50

## 목차

1. 와이 멀티모듈 프로젝트가 중요할까요?
2. 무엇을 기준으로 멀티 모듈 프로젝트 구조를 나눠야 할까요?
3. 어떻게 실전 멀티모듈 프로젝트 구현을 해야 할까요?

## 내용

### Why

- 아키텍처는 프로젝트 초기에 이루어져야 하는 일련의 설계 결정이다 - 말틴파울러
- 아키텍처는 요소의 구조와 그 관게에 관한것이다 - 소프트웨어 엔지니어링 연구소
- Res. 나중에 변경하려면 어렵다 → 프로젝트를 변경하면 배포 프로젝트 등을 다 변경해야 하기 때문에 나중에 하려면 어렵다
- 리스크를 줄이기위한 선택임
- 서비스 스펙이 많아지고 구현하는 코드가 증가하면 core 와 common 이 비대칭적으로 커짐
- 정말 Core와 Common 한가요?
    - 서비스 복잡도가 늘어나면 여러 repository를 사용하게됨 (캐싱 , RDBMS, NoSQL 등)
    - 커넥션풀이 너무 부족함 (여러 모듈이 참조하기 때문)
    - 특정 모듈이 하위 버전 라이브러리를 참조하면 업그레이드가 난해함
    - 참조하는 서비스가 많으면 어디서 사이드 이펙트가 터질지 모름 → 일단 서비스별로 if/else 코드들이 난무함
    - 만약 특정 클래스의 수정사항이 생긴다면 모든 프로젝트를 리빌드 해야함

### What → 무엇을 기준으로 나누어야 할까(중요)

- (추천책: 토끼책)
- 서비스 도메인 구조가 아니고, 기술베이스 지향적인 모듈 구조?
- 기술베이스로하면, 메타데이터가 여러개의 데이터베이스를 참조할 경우, 설계 자체가 불가능함
- 이렇게 점점 늘어나는 멀티모듈을 어떻게 나눠야 할까
    - 우선 Core, Common 은 삭제하고 이게 정말로 필요한지? 한번 더 고민해볼것
    - 바운디드 컨텍스트 - 경계 나누기 → DDD는 큰 모델을 서로 다른 Bounded Context로 나누고 상호 관계를 명시하여 처리
- 멀티모듈 그룹 경계 나누기
    - BOOT Server → batch, admin, api (코드의 변화가 가장 적게 나타남)
    - Data → 데이터 모듈 meta, user, chart
    - INFRA → 구현되고나면 변화는 적지만, 업데이틋시 큰 변화 발생 (연동모듈)
    - Cloud System → Config, gateway, discovery, aws, gcp, azure
    - 이런식으로 특징과 성격에 맞게 그룹의 경계를 나누고 구현해야 함

### How → 실전 멀티 모듈 프로젝트를 구현해야 할까?

- 실무에서 new Repository
    - 4개의 하위폴더로 경계를 생성 (boot, data, infra, cloud)
    - 하위에서 프로젝트명과 경계로 잘 구분
    - (v2 사진)
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/451e6e87-d0cf-431d-90d4-14e94d804480/Untitled.png)
    
    - 이렇게 운영하다보니까, 프로젝트가 늘어나서 빌드시간이 늘어나기때문에 리빌드가 어렵고, 특정 프로젝트의 변화에도 이벤트 후킹으로 배포가 다시 일어남
    - (나눈 사진)
    - 이렇게 나누었더니 프로젝트 경계가 명확해지고, 구현된 곳으로 상호 구현을 하면 됨
    - 관계구현
        - Boot server & Data → 서비스 관제를 어디다가 두어야 하나 → 두군데 모두 구현이 필요함 (사진 첨부)
        - Boot server ↔ Cloud System → istio 는 k8s 기반의 서비스 매쉬 플랫폼 → 만약 k8s 기반의 어플리케이션을 구축한다면 도입을 고민해봐야할 것

### Summary

- 왜 멀티모듈 프로젝트가 중요할까?
    - 잘못 구성되면 나중에 변경하기 고통스러움
    - 프로젝트 초기에 이루어져야 하는 일련의 설계 과정이때문
    - 개발 생산성에 막대한 영향을 미친다 → 빌드가 전체가 되어야하기 때문 → 개발 생산성이 떨어짐 → 문제가 생겼을때도 다시 리빌드 해야함
- 무엇을 기준으로 나눠야 할까요?
    - 경계 안에서 의미를 갖을 수 있는 그룹을 정의하는(나누느) 것이 가장 중요함 (Bounded Context)
    - 역할, 책임, 협력관계가 올바른지 고민해봐야함
    - Boot, Infra, Data, Cloud 등
- 어떻게 구현해야 할까요?
    - 프로젝트가 커지고 있다면 경계를 나누고 그 기준으로 소스 저장소를 분리한다.
    - INFRA(외부) 라이브러리 모듈은 data 관련 구현을 지향한다 (Anticoruption layer)
    - 서비스 구현은 각자 혁할에 맞게 각각 구현될 수 있다. (공통으로 한쪽에 구현하지 않는다.)
    - 시스템 레벨 구현이 실제 서비스 어플리케이션과 연관되지 않도록 격리하거나 전환(Istio) 한다.
- 콘웨이의 법칙(Conway`s Law) : 시스템을 설계하는 조직은 어떤 조직이든 그 조직의 소통 구조를 닮은 구조를 가진 시스템으로 설계할 것이다.
- “어떤 회사든 특정 시점에 부서가 나눠져있다가 붙기도 하는것처럼, 잘설계된 멀티모듈도 특정 시점에 나눠지거나 붙어질 수 있어야 좋은 멀티모듈 프로젝트라고 정의 할 수 있을 것”

### QA

- Core Common 을 삭제하면 누군가는 그걸 또 관리해야 하는데? → 일단 Core Common 이 없는상태로 시작하고 꼭 필요하면 별도의 라이브러리로 구현
- 멀티모듈을 구성할때마다 모듈간의 의존성을 어떻게 가져갈 것인가 → 질문자가 말해준 내용은 멀티모듈이면서도 DDD에 가까운 주제인 것 같다 (그렇게 해결해야 한다)
